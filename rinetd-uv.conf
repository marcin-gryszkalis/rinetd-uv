# rinetd-uv.conf - example configuration

# Logging
logfile /var/log/rinetd-uv.log
# logcommon  # Use Apache-style logging (default: off)

# PID file (default: /var/run/rinetd-uv.pid)
pidfile /var/run/rinetd-uv.pid

# Buffer size (1024-1048576, default: 65536)
buffersize 65536

# Buffer pool configuration
pool-min-free 64          # Min buffers to keep (0-10000, default: 64)
pool-max-free 1024        # Max buffers before trimming (1-100000, default: 1024)
pool-trim-delay 60000     # Trim delay in milliseconds (100-300000, default: 60000)

# DNS refresh interval (default: 600 seconds = 10 minutes)
dns-refresh 600

# DNS multi-IP expansion (default: off for .conf files)
# dns-multi-ip-expand on
# dns-multi-ip-proto ipv4  # ipv4, ipv6, or any (default: ipv4)

# Listen backlog (1-65535, default: 128)
listen-backlog 128

# Maximum UDP connections per forwarding rule (1-1000000, default: 5000)
max-udp-connections 5000

# Status reporting
statusfile /var/log/rinetd-uv_status.json
statusinterval 30         # Write interval in seconds (default: 30)
statusformat json         # json or text (default: json)
statsloginterval 60       # Log summary interval, 0 to disable (default: 60)

# Global access control (before any forwarding rules)
allow 192.168.2.*
deny 192.168.2.1?
allow fe80:*
deny 2001:618:*:e43f

# Include other configuration files
include /etc/rinetd-uv.d/*.conf
# include conf.d/servers.conf

# TCP forwarding examples
# Format: bindaddress bindport connectaddress connectport [options]
# Options: [timeout=N,src=address,keepalive=on/off,dns-refresh=N,mode=octal]
0.0.0.0 80/tcp 192.168.1.10 8080/tcp
192.168.0.1 https server.example.com 8443 [src=192.168.1.1]
0.0.0.0 444 api.example.com 444 [dns-refresh=60]
:: http ipv6.google.com http

# UDP forwarding example
0.0.0.0 53/udp 8.8.8.8 53/udp [timeout=30]

# Unix domain socket forwarding examples
0.0.0.0 2375/tcp unix:/var/run/docker.sock
unix:/var/run/myapp.sock 192.168.1.100 8080/tcp [mode=0660]

# Per-rule access control (applies to preceding forwarding rule)
0.0.0.0 22 192.168.1.20 22
allow 10.0.0.*

