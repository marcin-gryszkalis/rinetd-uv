'\" t
.\" Automatically generated by Pandoc 3.5
.\"
.TH "rinetd\-uv" "8" "2026\-01\-30" "rinetd\-uv 2.0"
.SH rinetd\-uv(8) \- internet redirection server
.SS NAME
rinetd\-uv \- internet redirection server
.SS SYNOPSIS
.IP
.EX
rinetd\-uv [\-f] [\-c configuration]
rinetd\-uv \-h
rinetd\-uv \-v
.EE
.SS DESCRIPTION
\f[B]rinetd\-uv\f[R] redirects TCP or UDP connections from one IP
address and port to another.
\f[B]rinetd\-uv\f[R] is a single\-process server which handles any
number of connections to the address/port pairs specified in the file
\f[CR]/etc/rinetd\-uv.conf\f[R] (legacy format) or
\f[CR]/etc/rinetd\-uv.yaml\f[R] (YAML format with load balancing
support).
Since \f[B]rinetd\-uv\f[R] runs as a single process using nonblocking
I/O (via libuv event loop), it is able to redirect a large number of
connections without a severe impact on the machine.
This makes it practical to run services on machines inside an IP
masquerading firewall.
.PP
The YAML configuration format (version 2.1.0+) adds support for
\f[B]load balancing\f[R] with multiple backend servers, health checking,
and client affinity.
See the \f[B]YAML CONFIGURATION FORMAT\f[R] section for details.
.SS Libuv
\f[B]rinetd\-uv\f[R] is a modernized implementation of the original
rinetd daemon, rewritten to use the libuv event loop library.
While maintaining backward compatibility with the original rinetd
configuration format, rinetd\-uv features a completely rewritten
internal architecture.
.SS RUN
\f[B]rinetd\-uv\f[R] is typically launched at boot time, using the
following syntax:
.IP
.EX
/usr/sbin/rinetd\-uv
.EE
.PP
When no \f[CR]\-c\f[R] option is provided, \f[B]rinetd\-uv\f[R] searches
for configuration files in the following order:
.IP "1." 3
\f[CR]/etc/rinetd\-uv.yaml\f[R] (YAML format with load balancing
support)
.IP "2." 3
\f[CR]/etc/rinetd\-uv.yml\f[R] (YAML format)
.IP "3." 3
\f[CR]/etc/rinetd\-uv.conf\f[R] (legacy format)
.PP
The first file found is used.
YAML configuration files enable load balancing features.
Use the \f[CR]\-c\f[R] option to specify an alternate configuration
file.
.SS Run with Docker
.SS From public registry
.IP \[bu] 2
https://hub.docker.com/r/marcingryszkalis/rinetd\-uv
.IP
.EX
docker pull marcingryszkalis/rinetd\-uv

docker run \-\-rm marcingryszkalis/rinetd\-uv:latest \-\-version

docker run \[rs]
   \-\-rm \[rs]
   \-\-name rinetd\-uv \[rs]
   \-\-ulimit nofile=65000 \[rs]
   \-\-publish 127.0.0.1:8080:8080 \[rs]
   \-\-publish 127.0.0.1:53535:53535/udp \[rs]
   \-\-volume ./rinetd\-uv.conf:/etc/rinetd\-uv.conf:ro \[rs]
   marcingryszkalis/rinetd\-uv
.EE
.SS Local build
.IP
.EX
docker build \-\-build\-arg VERSION=$(cat VERSION) \-t rinetd\-uv .

docker run \-\-rm rinetd\-uv \-\-version

docker run \[rs]
    \-\-rm \[rs]
    \-\-name rinetd\-uv \[rs]
    \-\-ulimit nofile=65000 \[rs]
    \-\-publish 127.0.0.1:8080:8080 \[rs]
    \-\-publish 127.0.0.1:53535:53535/udp \[rs]
    \-\-volume ./rinetd\-uv.conf:/etc/rinetd\-uv.conf:ro \[rs]
    rinetd\-uv
.EE
.SS OPTIONS
.TP
\f[B]\-f\f[R]
Run \f[B]rinetd\-uv\f[R] in the foreground, without forking to the
background.
.TP
\f[B]\-c\f[R] \f[I]configuration\f[R]
Specify an alternate configuration file.
.TP
\f[B]\-d\f[R]
Enable debug logging.
Shows detailed information about DNS refresh operations, connection
failures triggering re\-resolution, and other internal operations.
.TP
\f[B]\-v\f[R]
Display the version number and exit.
.TP
\f[B]\-h\f[R]
Produce a short help message and exit.
.SS FORWARDING RULES
Most entries in the configuration file are forwarding rules.
The format of a forwarding rule is as follows:
.IP
.EX
bindaddress bindport connectaddress connectport [options...]
.EE
.PP
For example:
.IP
.EX
206.125.69.81 80  10.1.1.2 80
.EE
.PP
Would redirect all connections to port 80 of the \[lq]real\[rq] IP
address 206.125.69.81, which could be a virtual interface, through
\f[B]rinetd\-uv\f[R] to port 80 of the address 10.1.1.2, which would
typically be a machine on the inside of a firewall which has no direct
routing to the outside world.
.PP
Although responding on individual interfaces rather than on all
interfaces is one of \f[B]rinetd\-uv\f[R]\[cq]s primary features,
sometimes it is preferable to respond on all IP addresses that belong to
the server.
In this situation, the special IP address \f[CR]0.0.0.0\f[R] can be
used.
For example:
.IP
.EX
0.0.0.0 23  10.1.1.2 23
.EE
.PP
Would redirect all connections to port 23, for all IP addresses assigned
to the server.
This is the default behavior for most other programs.
.SS Protocol Specification
Ports default to TCP.
To specify the protocol, append \f[CR]/udp\f[R] or \f[CR]/tcp\f[R] to
the port number:
.IP
.EX
206.125.69.81 80/tcp  10.1.1.2 8000/tcp
0.0.0.0 53/udp  8.8.8.8 53/udp
.EE
.PP
\f[B]Note:\f[R] Mixed\-mode forwarding (TCP to UDP or UDP to TCP) is not
currently supported.
.SS Service Names
Service names can be specified instead of port numbers.
On most systems, service names are defined in the file
\f[CR]/etc/services\f[R].
.SS IP Addresses and Hostnames
Both IP addresses and hostnames are accepted for \f[I]bindaddress\f[R]
and \f[I]connectaddress\f[R], including IPv6.
.SS FORWARDING OPTIONS
.SS UDP Timeout Option
Since UDP is a connectionless protocol, a timeout is necessary or
forwarding connections may accumulate with time and exhaust resources.
By default, if no data is sent or received on a UDP connection for 10
seconds, the other connection is closed.
This value can be changed using the \f[I]timeout\f[R] option:
.IP
.EX
0.0.0.0 8000/udp  10.1.1.2 53/udp  [timeout=3600]
.EE
.PP
This rule will forward all data received on UDP port 8000 to host
10.1.1.2 on UDP port 53, and will close the connection after no data is
received on the UDP port for 3600 seconds.
.PP
\f[B]Note:\f[R] rinetd\-uv limits UDP connections to 5000 concurrent
outgoing connections per forwarding rule (configurable via
\f[CR]max\-udp\-connections\f[R]) to prevent file descriptor exhaustion.
When this limit is reached, the oldest (least recently used) connection
is automatically closed to make room for new connections.
This is particularly important for high\-volume UDP proxies (e.g., DNS).
.SS Source Address Option
A forwarding rule option allows binding to a specific local address when
sending data to the other end.
This is done using the \f[I]src\f[R] option:
.IP
.EX
192.168.1.1 80  10.1.1.127 80  [src=10.1.1.2]
.EE
.PP
Assuming the local host has two IP addresses, 10.1.1.1 and 10.1.1.2,
this rule ensures that forwarded packets are sent using source address
10.1.1.2.
.SS TCP Keepalive Option
TCP keepalive is enabled by default for all TCP connections to detect
dead connections.
To disable it for a specific forwarding rule, use the
\f[I]keepalive\f[R] option:
.IP
.EX
192.168.1.1 80/tcp  10.1.1.127 80/tcp  [keepalive=off]
.EE
.PP
When enabled, keepalive probes are sent after 60 seconds of inactivity.
.SS DNS Refresh Option
For forwarding rules with backend hostnames (not IP addresses),
\f[B]rinetd\-uv\f[R] can automatically re\-resolve DNS hostnames at
configurable intervals.
This ensures that if a backend\[cq]s IP address changes, new connections
will use the updated address.
.PP
\f[B]Global configuration:\f[R]
.IP
.EX
dns\-refresh 600
.EE
.PP
This sets the default DNS refresh interval to 600 seconds (10 minutes)
for all forwarding rules with hostnames.
.PP
\f[B]Per\-rule configuration:\f[R]
.IP
.EX
0.0.0.0 8080/tcp backend.example.com 80 [dns\-refresh=300]
.EE
.PP
This overrides the global setting, refreshing this specific backend
every 300 seconds (5 minutes).
.PP
\f[B]Disable for specific rule:\f[R]
.IP
.EX
0.0.0.0 8081/tcp backend2.example.com 80 [dns\-refresh=0]
.EE
.PP
Setting \f[CR]dns\-refresh=0\f[R] disables periodic DNS refresh for this
rule.
.PP
\f[B]Behavior:\f[R]
.IP \[bu] 2
\f[B]Hostname detection:\f[R] DNS refresh is only enabled for backend
(target) hostnames.
Rules with IP addresses (IPv4 or IPv6) automatically skip DNS refresh.
.IP \[bu] 2
\f[B]Existing connections:\f[R] Continue using the old IP address until
they close naturally.
.IP \[bu] 2
\f[B]New connections:\f[R] Immediately use the newly resolved IP
address.
.IP \[bu] 2
\f[B]Failure\-triggered refresh:\f[R] After 3 consecutive connection
failures to a backend, DNS is re\-resolved immediately (regardless of
the timer interval).
.IP \[bu] 2
\f[B]SIGHUP compatibility:\f[R] Sending SIGHUP still forces immediate
re\-resolution of all hostnames (existing behavior preserved).
.PP
\f[B]Default:\f[R] 600 seconds (10 minutes)
.PP
\f[B]Example configuration:\f[R]
.IP
.EX
# Global default: refresh every 10 minutes
dns\-refresh 600

# Critical service: refresh more frequently
0.0.0.0 443/tcp api.example.com 443 [dns\-refresh=60]

# Static IP backend: no DNS refresh needed
0.0.0.0 8080/tcp 192.168.1.100 8080

# Long\-lived connections: refresh less frequently
0.0.0.0 8000/tcp cache.example.com 6379 [dns\-refresh=1800]

# Disable for this specific rule
0.0.0.0 9000/tcp static.example.com 9000 [dns\-refresh=0]
.EE
.SS UNIX DOMAIN SOCKETS
rinetd\-uv supports Unix domain sockets (also known as Unix sockets or
local sockets), allowing forwarding between TCP and Unix sockets in any
combination:
.IP \[bu] 2
\f[B]TCP to Unix socket\f[R] \- Expose a Unix socket service over TCP
(e.g.\ Docker socket proxy)
.IP \[bu] 2
\f[B]Unix socket to TCP\f[R] \- Accept connections on a Unix socket and
forward to TCP backend
.IP \[bu] 2
\f[B]Unix to Unix\f[R] \- Forward between Unix sockets
.SS Syntax
Unix socket addresses use the \f[CR]unix:\f[R] prefix followed by the
socket path:
.IP
.EX
unix:/path/to/socket    # Filesystem socket (absolute path required)
unix:\[at]name              # Abstract namespace socket (Linux only)
.EE
.PP
\f[B]Note:\f[R] No port number is required for Unix socket addresses.
.SS Examples
.IP
.EX
# TCP to Unix \- Docker socket proxy
# Clients connect to TCP port 2375, forwarded to Docker Unix socket
0.0.0.0 2375/tcp unix:/var/run/docker.sock

# Unix to TCP \- Accept on Unix socket, forward to HTTP server
unix:/var/run/frontend.sock 192.168.1.100 8080/tcp

# Unix to Unix \- Forward between Unix sockets
unix:/tmp/proxy.sock unix:/var/run/backend.sock

# Abstract namespace socket (Linux only)
# Abstract sockets don\[aq]t create filesystem entries
0.0.0.0 9999/tcp unix:\[at]myservice

# Unix socket with explicit permissions (owner and group read/write only)
unix:/var/run/restricted.sock 192.168.1.100 8080/tcp [mode=0660]
.EE
.SS Access Control
.IP \[bu] 2
For \f[B]filesystem sockets\f[R], access is controlled by filesystem
permissions on the socket file
.IP \[bu] 2
For \f[B]TCP endpoints\f[R], the standard \f[CR]allow\f[R] and
\f[CR]deny\f[R] rules apply
.IP \[bu] 2
IP\-based access control does not apply to incoming Unix socket
connections (access rules in such case will be ignored)
.IP \[bu] 2
For \f[B]abstract sockets\f[R] (Linux), any process in the same network
namespace can connect
.SS Security Considerations
.IP "1." 3
\f[B]Filesystem permissions\f[R]: By default, the socket file
permissions are determined by the process umask.
Use \f[CR][mode=0660]\f[R] to set explicit permissions.
.IP "2." 3
\f[B]Abstract sockets\f[R]: Accessible by any process in the same
network namespace \- use with caution.
The \f[CR]mode\f[R] option has no effect on abstract sockets.
.IP "3." 3
\f[B]Socket cleanup\f[R]: Filesystem sockets are automatically removed
on shutdown and before bind
.SS Limitations
.IP \[bu] 2
Maximum socket path length varies by system (Linux: 107, BSD: 103, some
other systems: 91)
.IP \[bu] 2
Unix sockets only support stream mode (SOCK_STREAM); datagram mode
(SOCK_DGRAM) or SCTP (SOCK_SEQPACKET) is not supported
.IP \[bu] 2
UDP forwarding cannot use Unix sockets
.IP \[bu] 2
Abstract namespace sockets are Linux\-specific and not portable
.IP \[bu] 2
Windows named pipes support is not tested although underlying libuv
declares they are covered, report a bug in case you need it.
.SS GLOBAL CONFIGURATION OPTIONS
.SS Buffer Size
The buffer size used for I/O operations can be configured globally.
This affects memory usage and performance characteristics.
.PP
If it\[cq]s expected that large UDP datagrams are to be processed make
sure that \f[CR]buffersize\f[R] is large enough to fit whole datagram
(theoretical maximum datagram size is 64KB).
Note that on FreeBSD it is required to set sysctl
\f[CR]net.inet.udp.maxdgram=65535\f[R] because default value is 9216 on
modern versions.
.IP
.EX
buffersize 32768
.EE
.PP
\f[B]Range:\f[R] 1024 to 1048576 bytes (1 KB to 1 MB) \f[B]Default:\f[R]
65536 bytes (64 KB)
.PP
\f[B]Recommendations:\f[R] \- \f[B]DNS proxy (small packets):\f[R]
\f[CR]buffersize 4096\f[R] \- Reduces memory usage (standard DNS packets
are limited to 512 bytes but EDNS0 extension allows up to 4KB) \-
\f[B]HTTP proxy (medium packets):\f[R] \f[CR]buffersize 32768\f[R] \-
Balanced performance \- \f[B]High throughput:\f[R]
\f[CR]buffersize 131072\f[R] \- Maximum performance (if memory allows)
\- \f[B]Memory\-constrained systems:\f[R] \f[CR]buffersize 4096\f[R] \-
Minimum practical size
.PP
The buffer size multiplied by the number of concurrent connections
determines total memory usage.
For example, with 1000 concurrent connections: \-
\f[CR]buffersize 4096\f[R]: \[ti]4 MB memory \-
\f[CR]buffersize 65536\f[R]: \[ti]64 MB memory
.SS DNS Refresh
The global DNS refresh interval can be configured to set the default for
all forwarding rules with backend hostnames:
.IP
.EX
dns\-refresh 600
.EE
.PP
\f[B]Range:\f[R] 0 to unlimited seconds \f[B]Default:\f[R] 600 seconds
(10 minutes)
.PP
This global setting applies to all forwarding rules unless overridden by
a per\-rule \f[CR][dns\-refresh=N]\f[R] option.
See the \f[B]DNS Refresh Option\f[R] section under \f[B]FORWARDING
OPTIONS\f[R] for detailed documentation and examples.
.SS Buffer Pool
\f[B]rinetd\-uv\f[R] uses a dynamic buffer pool to reduce memory
allocation overhead.
The pool maintains pre\-allocated buffers and lazily trims excess memory
after burst traffic subsides.
.IP
.EX
pool\-min\-free 64
pool\-max\-free 1024
pool\-trim\-delay 60000
.EE
.TP
\f[B]pool\-min\-free\f[R]
Minimum number of buffers to keep in the pool.
The pool will not shrink below this level.
\f[B]Range:\f[R] 0 to 10000
\f[B]Default:\f[R] 64
.TP
\f[B]pool\-max\-free\f[R]
Maximum number of buffers in the pool.
When returning a buffer to the pool and this limit is reached, the
buffer is freed immediately instead of being pooled.
\f[B]Range:\f[R] 1 to 100000
\f[B]Default:\f[R] 1024
.TP
\f[B]pool\-trim\-delay\f[R]
Milliseconds the pool must remain oversized (above
\f[CR]pool\-min\-free\f[R]) before excess buffers are trimmed.
This prevents aggressive memory churn during burst traffic.
\f[B]Range:\f[R] 100 to 300000 (100 ms to 5 minutes)
\f[B]Default:\f[R] 60000 (60 seconds)
.PP
\f[B]Memory Behavior:\f[R] \- When traffic starts, buffers are allocated
from the pool (or via \f[CR]malloc()\f[R] if the pool is empty) \- When
traffic ends, buffers are returned to the pool up to
\f[CR]pool\-max\-free\f[R] \- If the pool remains oversized for
\f[CR]pool\-trim\-delay\f[R] milliseconds, excess buffers are freed \-
Pool warming pre\-allocates \f[CR]pool\-min\-free\f[R] buffers at
startup for consistent initial performance
.PP
\f[B]Recommendations:\f[R] \- \f[B]Low traffic servers:\f[R]
\f[CR]pool\-min\-free 16\f[R] \f[CR]pool\-max\-free 128\f[R] \- Reduces
idle memory usage \- \f[B]Burst traffic servers:\f[R]
\f[CR]pool\-min\-free 64\f[R] \f[CR]pool\-max\-free 2048\f[R] \- Handles
bursts without thrashing \- \f[B]High traffic servers:\f[R]
\f[CR]pool\-min\-free 256\f[R] \f[CR]pool\-max\-free 4096\f[R] \-
Pre\-allocated capacity for sustained load \-
\f[B]Memory\-constrained:\f[R] \f[CR]pool\-max\-free 64\f[R]
\f[CR]pool\-trim\-delay 10000\f[R] \- Aggressive memory reclamation
.SS Listen Backlog
The TCP/Unix socket listen backlog determines how many pending
connections can queue before the OS starts rejecting new ones.
.IP
.EX
listen\-backlog 256
.EE
.PP
\f[B]Range:\f[R] 1 to 65535 \f[B]Default:\f[R] 128
.PP
Higher values are useful for servers that handle connection bursts.
Lower values are appropriate for low\-traffic or resource\-constrained
environments.
.SS Maximum UDP Connections
The maximum number of concurrent UDP connections (backend sockets) per
forwarding rule.
When this limit is reached, the oldest (least recently used) connection
is automatically evicted.
.IP
.EX
max\-udp\-connections 10000
.EE
.PP
\f[B]Range:\f[R] 1 to 1000000 \f[B]Default:\f[R] 5000
.PP
Each UDP connection uses a file descriptor, so ensure your system\[cq]s
\f[CR]ulimit \-n\f[R] is set high enough to accommodate the configured
limit multiplied by the number of UDP forwarding rules.
.SS Logging
\f[B]rinetd\-uv\f[R] is able to produce a log file in either of two
formats: tab\-delimited and web server\-style \[lq]common log
format\[rq].
.PP
By default, \f[B]rinetd\-uv\f[R] does not produce a log file.
To activate logging, add the following line to the configuration file:
.IP
.EX
logfile /var/log/rinetd\-uv.log
.EE
.PP
By default, \f[B]rinetd\-uv\f[R] logs in a simple tab\-delimited format
containing the following information:
.IP \[bu] 2
Date and time
.IP \[bu] 2
Client address
.IP \[bu] 2
Listening host
.IP \[bu] 2
Listening port
.IP \[bu] 2
Forwarded\-to host
.IP \[bu] 2
Forwarded\-to port
.IP \[bu] 2
Bytes received from client
.IP \[bu] 2
Bytes sent to client
.IP \[bu] 2
Result message
.PP
To activate web server\-style \[lq]common log format\[rq] logging, add
the following line to the configuration file:
.IP
.EX
logcommon
.EE
.SS PID File
Under Linux the process ID is saved in the file
\f[CR]/var/run/rinetd\-uv.pid\f[R] by default.
An alternate filename can be provided:
.IP
.EX
pidfile /var/run/myrinetd\-uv.pid
.EE
.SS INCLUDE DIRECTIVE
Configuration files can include other configuration files using the
\f[CR]include\f[R] directive.
This allows splitting large configurations into multiple files for
better organization and maintainability.
.SS Syntax
.IP
.EX
include pattern
.EE
.PP
The \f[CR]pattern\f[R] can be: \- \f[B]Single file\f[R]:
\f[CR]include servers.conf\f[R] \- \f[B]Wildcard pattern\f[R]:
\f[CR]include conf.d/*.conf\f[R] \- \f[B]Absolute path\f[R]:
\f[CR]include /etc/rinetd\-uv/servers.conf\f[R] \- \f[B]Relative
path\f[R]: Resolved relative to the current config file\[cq]s directory
.SS Features
.IP \[bu] 2
\f[B]Wildcard Support\f[R]: Use glob patterns like \f[CR]*.conf\f[R] or
\f[CR]server\-*.conf\f[R] to include multiple files
.IP \[bu] 2
\f[B]Nested Includes\f[R]: Included files can include other files (up to
10 levels deep)
.IP \[bu] 2
\f[B]Circular Detection\f[R]: Automatically prevents circular includes
.IP \[bu] 2
\f[B]Depth Limit\f[R]: Maximum include depth is 10 levels to prevent
infinite recursion
.IP \[bu] 2
\f[B]Optional Includes\f[R]: If a pattern matches no files, a warning is
logged but parsing continues
.IP \[bu] 2
\f[B]Sorted Loading\f[R]: When using wildcards, files are loaded in
alphabetical order
.SS Examples
\f[B]Basic include:\f[R]
.IP
.EX
# Include a single file
include /etc/rinetd\-uv.d/database\-servers.conf
.EE
.PP
\f[B]Wildcard pattern:\f[R]
.IP
.EX
# Include all .conf files from a directory
include /etc/rinetd\-uv.d/*.conf
.EE
.PP
\f[B]Relative paths:\f[R]
.IP
.EX
# In /etc/rinetd\-uv.conf:
include conf.d/*.conf

# This resolves to /etc/conf.d/*.conf
.EE
.PP
\f[B]Organized configuration structure:\f[R]
.IP
.EX
# Main config: /etc/rinetd\-uv.conf
logfile /var/log/rinetd\-uv.log
pidfile /var/run/rinetd\-uv.pid

# Global access control
allow 10.0.0.*
deny 192.168.1.100

# Include server\-specific configs
include conf.d/web\-servers.conf
include conf.d/database\-servers.conf
include conf.d/dns\-servers.conf
.EE
.SS Error Handling
.IP \[bu] 2
\f[B]No matches\f[R]: If a pattern matches no files, a warning is logged
and parsing continues
.IP \[bu] 2
\f[B]Circular includes\f[R]: Detected and causes immediate error
.IP \[bu] 2
\f[B]Maximum depth exceeded\f[R]: More than 10 levels of nesting causes
an error
.IP \[bu] 2
\f[B]File not found\f[R]: Individual file errors cause immediate failure
.IP \[bu] 2
\f[B]Permission denied\f[R]: Causes immediate error
.SS ALLOW AND DENY RULES
Configuration files can also contain allow and deny rules.
.PP
Allow rules which appear \f[B]before the first forwarding rule\f[R] are
applied globally: if at least one global allow rule exists, and the
address of a new connection does not satisfy at least one of the global
allow rules, that connection is immediately rejected, regardless of any
other rules.
.PP
Allow rules which appear \f[B]after a specific forwarding rule\f[R]
apply to that forwarding rule only.
If at least one allow rule exists for a particular forwarding rule, and
the address of a new connection does not satisfy at least one of the
allow rules for that forwarding rule, that connection is immediately
rejected, regardless of any other rules.
.PP
Deny rules which appear \f[B]before the first forwarding rule\f[R] are
applied globally: if the address of a new connection satisfies any of
the global deny rules, that connection is immediately rejected,
regardless of any other rules.
.PP
Deny rules which appear \f[B]after a specific forwarding rule\f[R] apply
to that forwarding rule only.
If the address of a new connection satisfies any of the deny rules for
that forwarding rule, that connection is immediately rejected,
regardless of any other rules.
.SS Rule Format
The format of an allow or deny rule is as follows:
.IP
.EX
allow pattern
deny pattern
.EE
.PP
Patterns can contain the following characters: \f[CR]0\f[R],
\f[CR]1\f[R], \f[CR]2\f[R], \f[CR]3\f[R], \f[CR]4\f[R], \f[CR]5\f[R],
\f[CR]6\f[R], \f[CR]7\f[R], \f[CR]8\f[R], \f[CR]9\f[R], \f[CR].\f[R]
(period), \f[CR]?\f[R], and \f[CR]*\f[R].
The \f[CR]?\f[R] wildcard matches any one character.
The \f[CR]*\f[R] wildcard matches any number of characters, including
zero.
.PP
For example:
.IP
.EX
allow 206.125.69.*
.EE
.PP
This allow rule matches all IP addresses in the 206.125.69 class C
domain.
.PP
\f[B]Important:\f[R] Host names are \f[B]NOT\f[R] permitted in allow and
deny rules.
The performance cost of looking up IP addresses to find their
corresponding names is prohibitive.
Since \f[B]rinetd\-uv\f[R] is a single process server, all other
connections would be forced to pause during the address lookup.
.SS YAML CONFIGURATION FORMAT
Starting with version 2.1.0, \f[B]rinetd\-uv\f[R] supports an
alternative YAML configuration format that enables advanced features
including load balancing.
The YAML format is detected automatically by file extension
(\f[CR].yaml\f[R] or \f[CR].yml\f[R]).
.PP
\f[B]Note:\f[R] YAML configuration requires \f[B]libyaml\f[R] to be
installed at build time.
If libyaml is not available, YAML configuration will be disabled but the
legacy format continues to work.
.SS Overview
The YAML configuration provides:
.IP \[bu] 2
\f[B]Load balancing\f[R] with multiple algorithms (round\-robin,
least\-connections, random, IP\-hash)
.IP \[bu] 2
\f[B]Many\-to\-many forwarding\f[R] (multiple listeners to multiple
backends)
.IP \[bu] 2
\f[B]Weighted backends\f[R] for proportional traffic distribution
.IP \[bu] 2
\f[B]Passive health checking\f[R] with automatic failover
.IP \[bu] 2
\f[B]Client IP affinity\f[R] (session persistence)
.IP \[bu] 2
\f[B]Per\-backend DNS refresh\f[R] overrides
.SS Basic Structure
.IP
.EX
\f[I]# rinetd\-uv.yaml\f[R]
global\f[B]:\f[R]
  buffer_size\f[B]:\f[R] 65536
  dns_refresh\f[B]:\f[R] 600
  log_file\f[B]:\f[R] /var/log/rinetd\-uv.log
  pid_file\f[B]:\f[R] /var/run/rinetd\-uv.pid

rules\f[B]:\f[R]
  \f[B]\-\f[R] name\f[B]:\f[R] my\-rule
    bind\f[B]:\f[R] \[dq]0.0.0.0:8080/tcp\[dq]
    connect\f[B]:\f[R] \[dq]backend.example.com:80\[dq]
.EE
.SS Global Settings
The \f[CR]global\f[R] section configures server\-wide options.
All settings are optional and have sensible defaults.
.PP
.TS
tab(@);
lw(17.0n) lw(11.4n) lw(17.0n) lw(24.6n).
T{
Setting
T}@T{
Type
T}@T{
Default
T}@T{
Description
T}
_
T{
\f[CR]buffer_size\f[R]
T}@T{
integer
T}@T{
65536
T}@T{
I/O buffer size in bytes (1024\-1048576)
T}
T{
\f[CR]dns_refresh\f[R]
T}@T{
integer
T}@T{
600
T}@T{
Default DNS refresh interval in seconds
T}
T{
\f[CR]log_file\f[R]
T}@T{
string
T}@T{
none
T}@T{
Path to log file
T}
T{
\f[CR]log_common\f[R]
T}@T{
boolean
T}@T{
false
T}@T{
Use Apache\-style common log format
T}
T{
\f[CR]pid_file\f[R]
T}@T{
string
T}@T{
/var/run/rinetd\-uv.pid
T}@T{
Path to PID file
T}
T{
\f[CR]max_udp_connections\f[R]
T}@T{
integer
T}@T{
5000
T}@T{
Max UDP connections per rule
T}
T{
\f[CR]listen_backlog\f[R]
T}@T{
integer
T}@T{
128
T}@T{
TCP listen backlog
T}
T{
\f[CR]pool_min_free\f[R]
T}@T{
integer
T}@T{
64
T}@T{
Minimum pooled buffers
T}
T{
\f[CR]pool_max_free\f[R]
T}@T{
integer
T}@T{
1024
T}@T{
Maximum pooled buffers
T}
T{
\f[CR]pool_trim_delay\f[R]
T}@T{
integer
T}@T{
60000
T}@T{
Pool trim delay in milliseconds
T}
.TE
.SS Rules
The \f[CR]rules\f[R] section is a list of forwarding rules.
Each rule has the following structure:
.IP
.EX
rules\f[B]:\f[R]
  \f[B]\-\f[R] name\f[B]:\f[R] rule\-name\f[I]              # Required: unique identifier\f[R]
    bind\f[B]:\f[R] \[dq]address:port/proto\[dq]\f[I]   # Required: listen address(es)\f[R]
    connect\f[B]:\f[R] \[dq]host:port/proto\[dq]\f[I]   # Required: destination(s)\f[R]
\f[I]    # or for multiple destinations:\f[R]
\f[I]    # connect:\f[R]
\f[I]    #   \- dest: \[dq]host1:port/proto\[dq]\f[R]
\f[I]    #   \- dest: \[dq]host2:port/proto\[dq]\f[R]
    load_balancing\f[B]:\f[R]\f[I]              # Optional: LB configuration\f[R]
      algorithm\f[B]:\f[R] roundrobin
    access\f[B]:\f[R]\f[I]                      # Optional: access control\f[R]
      allow\f[B]:\f[R] \f[B][\f[R]\[dq]192.168.*\[dq]\f[B]]\f[R]
      deny\f[B]:\f[R] \f[B][\f[R]\[dq]*\[dq]\f[B]]\f[R]
    timeout\f[B]:\f[R] 10\f[I]                  # Optional: UDP timeout (seconds)\f[R]
    keepalive\f[B]:\f[R] true\f[I]              # Optional: TCP keepalive (default: true)\f[R]
.EE
.SS Bind Address Format
The \f[CR]bind\f[R] field specifies the listening address.
It can be a single address or a list for many\-to\-many forwarding:
.IP
.EX
\f[I]# Single listener\f[R]
bind\f[B]:\f[R] \[dq]0.0.0.0:8080/tcp\[dq]

\f[I]# Multiple listeners (fan\-in)\f[R]
bind\f[B]:\f[R]
  \f[B]\-\f[R] \[dq]0.0.0.0:80/tcp\[dq]
  \f[B]\-\f[R] \[dq]0.0.0.0:443/tcp\[dq]
  \f[B]\-\f[R] \[dq][::]:80/tcp\[dq]

\f[I]# Unix socket\f[R]
bind\f[B]:\f[R] \[dq]unix:/var/run/proxy.sock\[dq]
.EE
.PP
Format: \f[CR]address:port/protocol\f[R] where: \- \f[CR]address\f[R]:
IP address, hostname, or \f[CR]unix:/path\f[R] \- \f[CR]port\f[R]: Port
number or service name \- \f[CR]protocol\f[R]: \f[CR]tcp\f[R] or
\f[CR]udp\f[R] (default: tcp)
.SS Connect Destinations
The \f[CR]connect\f[R] field specifies destination servers.
It can be a single destination string or a list for load balancing:
.IP
.EX
\f[I]# Single destination (simple syntax)\f[R]
connect\f[B]:\f[R] \[dq]backend.example.com:8080/tcp\[dq]

\f[I]# Multiple destinations for load balancing\f[R]
connect\f[B]:\f[R]
  \f[B]\-\f[R] dest\f[B]:\f[R] \[dq]web1.example.com:8080\[dq]
    weight\f[B]:\f[R] 2\f[I]              # Optional: for weighted algorithms\f[R]
    dns_refresh\f[B]:\f[R] 60\f[I]        # Optional: per\-backend DNS refresh\f[R]
    src\f[B]:\f[R] 10.1.1.2\f[I]          # Optional: source address\f[R]

  \f[B]\-\f[R] dest\f[B]:\f[R] \[dq]web2.example.com:8080\[dq]
    weight\f[B]:\f[R] 1

\f[I]  # Unix socket backend\f[R]
  \f[B]\-\f[R] dest\f[B]:\f[R] \[dq]unix:/var/run/backend.sock\[dq]
.EE
.PP
Format: \f[CR]address:port/protocol\f[R] where: \- \f[CR]address\f[R]:
IP address, hostname, or \f[CR]unix:/path\f[R] \- \f[CR]port\f[R]: Port
number or service name \- \f[CR]protocol\f[R]: \f[CR]tcp\f[R] or
\f[CR]udp\f[R] (default: tcp)
.PP
.TS
tab(@);
lw(14.0n) lw(12.0n) lw(18.0n) lw(26.0n).
T{
Field
T}@T{
Type
T}@T{
Default
T}@T{
Description
T}
_
T{
\f[CR]dest\f[R]
T}@T{
string
T}@T{
required
T}@T{
Destination address in \f[CR]host:port/proto\f[R] or
\f[CR]unix:path\f[R] format
T}
T{
\f[CR]weight\f[R]
T}@T{
integer
T}@T{
1
T}@T{
Weight for weighted algorithms
T}
T{
\f[CR]dns_refresh\f[R]
T}@T{
integer
T}@T{
rule default
T}@T{
DNS refresh interval override
T}
T{
\f[CR]src\f[R]
T}@T{
string
T}@T{
none
T}@T{
Source address for outgoing connections
T}
.TE
.SS Load Balancing
When a rule has multiple backends, load balancing is automatically
enabled.
Configure the algorithm and behavior with the \f[CR]load_balancing\f[R]
section:
.IP
.EX
load_balancing\f[B]:\f[R]
  algorithm\f[B]:\f[R] roundrobin\f[I]      # Algorithm to use\f[R]
  health_threshold\f[B]:\f[R] 3\f[I]        # Failures before marking unhealthy\f[R]
  recovery_timeout\f[B]:\f[R] 30\f[I]       # Seconds before retry after unhealthy\f[R]
  affinity_ttl\f[B]:\f[R] 300\f[I]          # Client affinity TTL (0 = disabled)\f[R]
  affinity_max_entries\f[B]:\f[R] 10000\f[I] # Max affinity table entries\f[R]
.EE
.SS Algorithms
.PP
.TS
tab(@);
lw(32.1n) lw(37.9n).
T{
Algorithm
T}@T{
Description
T}
_
T{
\f[CR]roundrobin\f[R]
T}@T{
Distributes connections evenly in circular order.
With weights, uses smooth weighted round\-robin for proportional
distribution.
T}
T{
\f[CR]leastconn\f[R]
T}@T{
Sends to backend with fewest active connections.
Good for varying request durations.
T}
T{
\f[CR]random\f[R]
T}@T{
Random selection.
Simple and effective for uniform loads.
T}
T{
\f[CR]iphash\f[R]
T}@T{
Consistent routing based on client IP hash.
Same client always goes to same backend (unless unhealthy).
T}
.TE
.PP
\f[B]Default:\f[R] \f[CR]roundrobin\f[R]
.SS Weighted Distribution
Weights control the proportion of traffic each backend receives:
.IP
.EX
connect\f[B]:\f[R]
  \f[B]\-\f[R] dest\f[B]:\f[R] \[dq]web1.example.com:8080\[dq]
    weight\f[B]:\f[R] 3\f[I]    # Receives 3/6 = 50% of traffic\f[R]

  \f[B]\-\f[R] dest\f[B]:\f[R] \[dq]web2.example.com:8080\[dq]
    weight\f[B]:\f[R] 2\f[I]    # Receives 2/6 = 33% of traffic\f[R]

  \f[B]\-\f[R] dest\f[B]:\f[R] \[dq]web3.example.com:8080\[dq]
    weight\f[B]:\f[R] 1\f[I]    # Receives 1/6 = 17% of traffic\f[R]
.EE
.PP
Weights are respected by \f[CR]roundrobin\f[R] and \f[CR]random\f[R]
algorithms.
The \f[CR]leastconn\f[R] algorithm considers weights as a tiebreaker.
.SS Health Checking
\f[B]rinetd\-uv\f[R] performs passive health checking based on
connection success/failure:
.IP "1." 3
\f[B]Connection succeeds:\f[R] Backend marked healthy, failure counter
reset
.IP "2." 3
\f[B]Connection fails:\f[R] Failure counter incremented
.IP "3." 3
\f[B]Threshold reached:\f[R] Backend marked unhealthy after
\f[CR]health_threshold\f[R] consecutive failures
.IP "4." 3
\f[B]Recovery:\f[R] After \f[CR]recovery_timeout\f[R] seconds, unhealthy
backend becomes eligible for retry
.IP "5." 3
\f[B]All unhealthy:\f[R] If all backends are unhealthy, traffic is
distributed anyway (fail\-open)
.IP
.EX
load_balancing\f[B]:\f[R]
  health_threshold\f[B]:\f[R] 3\f[I]      # Mark unhealthy after 3 failures\f[R]
  recovery_timeout\f[B]:\f[R] 30\f[I]     # Retry after 30 seconds\f[R]
.EE
.PP
\f[B]Note:\f[R] DNS is automatically re\-resolved when a backend reaches
the failure threshold.
.SS Client Affinity (Session Persistence)
Client affinity ensures the same client IP is routed to the same backend
within a time window:
.IP
.EX
load_balancing\f[B]:\f[R]
  affinity_ttl\f[B]:\f[R] 300\f[I]            # 5 minutes\f[R]
  affinity_max_entries\f[B]:\f[R] 10000\f[I]  # Maximum tracked clients\f[R]
.EE
.IP \[bu] 2
\f[B]TTL:\f[R] Time\-to\-live in seconds.
Each connection refreshes the timer.
.IP \[bu] 2
\f[B]Max entries:\f[R] When full, least\-recently\-used entries are
evicted.
.IP \[bu] 2
\f[B]Health\-aware:\f[R] If the affinity target is unhealthy, a new
backend is selected.
.PP
Set \f[CR]affinity_ttl: 0\f[R] to disable affinity (default).
.SS Access Control
Access control in YAML uses the same pattern matching as the legacy
format:
.IP
.EX
access\f[B]:\f[R]
  allow\f[B]:\f[R]
    \f[B]\-\f[R] \[dq]192.168.*\[dq]
    \f[B]\-\f[R] \[dq]10.0.0.*\[dq]
  deny\f[B]:\f[R]
    \f[B]\-\f[R] \[dq]192.168.1.100\[dq]
    \f[B]\-\f[R] \[dq]*\[dq]
.EE
.PP
Rules are evaluated in order: allow rules checked first, then deny
rules.
.SS YAML Configuration Examples
.SS Simple 1:1 Forwarding
.IP
.EX
global\f[B]:\f[R]
  log_file\f[B]:\f[R] /var/log/rinetd\-uv.log

rules\f[B]:\f[R]
  \f[B]\-\f[R] name\f[B]:\f[R] web\-forward
    bind\f[B]:\f[R] \[dq]0.0.0.0:80/tcp\[dq]
    connect\f[B]:\f[R] \[dq]192.168.1.100:8080\[dq]
.EE
.SS Load Balanced Web Cluster
.IP
.EX
global\f[B]:\f[R]
  buffer_size\f[B]:\f[R] 65536
  dns_refresh\f[B]:\f[R] 300

rules\f[B]:\f[R]
  \f[B]\-\f[R] name\f[B]:\f[R] web\-cluster
    bind\f[B]:\f[R]
      \f[B]\-\f[R] \[dq]0.0.0.0:80/tcp\[dq]
      \f[B]\-\f[R] \[dq]0.0.0.0:443/tcp\[dq]
    connect\f[B]:\f[R]
      \f[B]\-\f[R] dest\f[B]:\f[R] \[dq]web1.internal:8080\[dq]
        weight\f[B]:\f[R] 2
      \f[B]\-\f[R] dest\f[B]:\f[R] \[dq]web2.internal:8080\[dq]
        weight\f[B]:\f[R] 2
      \f[B]\-\f[R] dest\f[B]:\f[R] \[dq]web3.internal:8080\[dq]
        weight\f[B]:\f[R] 1
    load_balancing\f[B]:\f[R]
      algorithm\f[B]:\f[R] roundrobin
      health_threshold\f[B]:\f[R] 3
      recovery_timeout\f[B]:\f[R] 30
    access\f[B]:\f[R]
      allow\f[B]:\f[R] \f[B][\f[R]\[dq]10.*\[dq]\f[B],\f[R] \[dq]192.168.*\[dq]\f[B]]\f[R]
      deny\f[B]:\f[R] \f[B][\f[R]\[dq]*\[dq]\f[B]]\f[R]
.EE
.SS DNS Load Balancing (UDP)
.IP
.EX
rules\f[B]:\f[R]
  \f[B]\-\f[R] name\f[B]:\f[R] dns\-lb
    bind\f[B]:\f[R] \[dq]0.0.0.0:53/udp\[dq]
    connect\f[B]:\f[R]
      \f[B]\-\f[R] dest\f[B]:\f[R] \[dq]8.8.8.8:53/udp\[dq]
      \f[B]\-\f[R] dest\f[B]:\f[R] \[dq]8.8.4.4:53/udp\[dq]
      \f[B]\-\f[R] dest\f[B]:\f[R] \[dq]1.1.1.1:53/udp\[dq]
    load_balancing\f[B]:\f[R]
      algorithm\f[B]:\f[R] roundrobin
    timeout\f[B]:\f[R] 10
.EE
.SS Sticky Sessions with IP Hash
.IP
.EX
rules\f[B]:\f[R]
  \f[B]\-\f[R] name\f[B]:\f[R] app\-servers
    bind\f[B]:\f[R] \[dq]0.0.0.0:8080/tcp\[dq]
    connect\f[B]:\f[R]
      \f[B]\-\f[R] dest\f[B]:\f[R] \[dq]app1.internal:3000\[dq]
      \f[B]\-\f[R] dest\f[B]:\f[R] \[dq]app2.internal:3000\[dq]
    load_balancing\f[B]:\f[R]
      algorithm\f[B]:\f[R] iphash
      affinity_ttl\f[B]:\f[R] 3600\f[I]  # 1 hour sticky sessions\f[R]
.EE
.SS Unix Socket Proxy
.IP
.EX
rules\f[B]:\f[R]
  \f[B]\-\f[R] name\f[B]:\f[R] docker\-proxy
    bind\f[B]:\f[R] \[dq]0.0.0.0:2375/tcp\[dq]
    connect\f[B]:\f[R] \[dq]unix:/var/run/docker.sock\[dq]
    access\f[B]:\f[R]
      allow\f[B]:\f[R] \f[B][\f[R]\[dq]10.0.0.*\[dq]\f[B]]\f[R]
      deny\f[B]:\f[R] \f[B][\f[R]\[dq]*\[dq]\f[B]]\f[R]
.EE
.SS Converting from Legacy Format
A Python conversion script is provided to migrate legacy configurations
to YAML:
.IP
.EX
python3 tools/conf2yaml.py /etc/rinetd\-uv.conf > /etc/rinetd\-uv.yaml
.EE
.PP
The script converts: \- Global options (buffersize, dns\-refresh,
logfile, etc.)
\- Forwarding rules with all options \- Allow and deny rules (global and
per\-rule)
.PP
\f[B]Note:\f[R] The legacy format does not support load balancing.
After conversion, you can manually add multiple backends and
load_balancing configuration to rules.
.SS YAML vs Legacy Format Comparison
.PP
.TS
tab(@);
l l l.
T{
Feature
T}@T{
Legacy Format
T}@T{
YAML Format
T}
_
T{
Basic forwarding
T}@T{
✓
T}@T{
✓
T}
T{
UDP forwarding
T}@T{
✓
T}@T{
✓
T}
T{
Unix sockets
T}@T{
✓
T}@T{
✓
T}
T{
Access control
T}@T{
✓
T}@T{
✓
T}
T{
DNS refresh
T}@T{
✓
T}@T{
✓
T}
T{
Multiple backends
T}@T{
✗
T}@T{
✓
T}
T{
Load balancing
T}@T{
✗
T}@T{
✓
T}
T{
Health checking
T}@T{
✗
T}@T{
✓
T}
T{
Client affinity
T}@T{
✗
T}@T{
✓
T}
T{
Weighted distribution
T}@T{
✗
T}@T{
✓
T}
T{
Multiple listeners per rule
T}@T{
✗
T}@T{
✓
T}
.TE
.SS EXAMPLE CONFIGURATION
.SS Legacy Format
.IP
.EX
# rinetd\-uv.conf \- example configuration

# Global options
logfile /var/log/rinetd\-uv.log
# logcommon  # Use Apache\-style logging

# PID file
pidfile /var/run/rinetd\-uv.pid

# Buffer size configuration (1KB \- 1MB, default: 65536)
# Smaller values reduce memory usage and latency, larger values improve throughput
buffersize 65536  # 64KB is the default

# Buffer pool configuration (reduces allocation overhead)
# Min buffers to keep (0\-10000, default: 64)
pool\-min\-free 64
# Max buffers before trimming (1\-100000, default: 1024)
pool\-max\-free 1024
# Time before freeing excess, in milliseconds (100\-300000, default: 60000)
pool\-trim\-delay 60000

# DNS refresh interval (default: 600 seconds = 10 minutes)
# Automatically re\-resolves backend hostnames at specified intervals
# Set to 0 to disable, or override per\-rule with [dns\-refresh=N]
dns\-refresh 600

# Listen backlog (1\-65535, default: 128)
# Higher values allow more pending connections during bursts
listen\-backlog 128

# Maximum UDP connections per forwarding rule (1\-1000000, default: 5000)
max\-udp\-connections 5000

# Global Access Control:
# You may specify global allow and deny rules here.
# Only ip addresses are matched, hostnames cannot be specified here.
# The wildcards you may use are * and ?
#
allow 192.168.2.*
deny 192.168.2.1?
allow fe80:*
deny 2001:618:*:e43f

# You can split your configuration across multiple files
include /etc/rinetd\-uv.d/*.conf
# include conf.d/servers.conf

# Forwarding options:
# Format: bindaddress bindport connectaddress connectport [options]
# Options: [timeout=seconds,src=sourceaddress,keepalive=on/off,dns\-refresh=seconds,mode=octal]
# Note: TCP keepalive is enabled by default
# Note: mode option sets Unix socket file permissions (e.g. mode=0660)

# TCP forwarding examples
0.0.0.0 80/tcp 192.168.1.10 8080/tcp
192.168.0.1 https server.example.com 8443 [src=192.168.1.1]
0.0.0.0 444 api.example.com 444 [dns\-refresh=60]
:: http ipv6.google.com http

# UDP forwarding example
0.0.0.0 53/udp 8.8.8.8 53/udp [timeout=30]

# Unix domain socket forwarding examples
# TCP to Unix socket \- Docker socket proxy
0.0.0.0 2375/tcp unix:/var/run/docker.sock
# Unix to TCP forwarding with restricted permissions
unix:/var/run/myapp.sock 192.168.1.100 8080/tcp [mode=0660]

# Per\-rule Access Control (applies to previous forwarding rule)
0.0.0.0 22 192.168.1.20 22
allow 10.0.0.*
.EE
.SS YAML Format
.IP
.EX
\f[I]# rinetd\-uv.yaml \- example configuration with load balancing\f[R]

global\f[B]:\f[R]
  buffer_size\f[B]:\f[R] 65536
  dns_refresh\f[B]:\f[R] 600
  log_file\f[B]:\f[R] /var/log/rinetd\-uv.log
  pid_file\f[B]:\f[R] /var/run/rinetd\-uv.pid
  pool_min_free\f[B]:\f[R] 64
  pool_max_free\f[B]:\f[R] 1024

rules\f[B]:\f[R]
\f[I]  # Simple 1:1 forwarding (equivalent to legacy format)\f[R]
  \f[B]\-\f[R] name\f[B]:\f[R] simple\-forward
    bind\f[B]:\f[R] \[dq]0.0.0.0:80/tcp\[dq]
    connect\f[B]:\f[R] \[dq]192.168.1.10:8080\[dq]

\f[I]  # Load balanced web servers with weighted round\-robin\f[R]
  \f[B]\-\f[R] name\f[B]:\f[R] web\-cluster
    bind\f[B]:\f[R]
      \f[B]\-\f[R] \[dq]0.0.0.0:443/tcp\[dq]
      \f[B]\-\f[R] \[dq][::]:443/tcp\[dq]
    connect\f[B]:\f[R]
      \f[B]\-\f[R] dest\f[B]:\f[R] \[dq]web1.internal:8443\[dq]
        weight\f[B]:\f[R] 3
      \f[B]\-\f[R] dest\f[B]:\f[R] \[dq]web2.internal:8443\[dq]
        weight\f[B]:\f[R] 2
      \f[B]\-\f[R] dest\f[B]:\f[R] \[dq]web3.internal:8443\[dq]
        weight\f[B]:\f[R] 1
    load_balancing\f[B]:\f[R]
      algorithm\f[B]:\f[R] roundrobin
      health_threshold\f[B]:\f[R] 3
      recovery_timeout\f[B]:\f[R] 30
    access\f[B]:\f[R]
      allow\f[B]:\f[R] \f[B][\f[R]\[dq]10.*\[dq]\f[B],\f[R] \[dq]192.168.*\[dq]\f[B]]\f[R]
      deny\f[B]:\f[R] \f[B][\f[R]\[dq]*\[dq]\f[B]]\f[R]

\f[I]  # DNS servers with least\-connections algorithm\f[R]
  \f[B]\-\f[R] name\f[B]:\f[R] dns\-lb
    bind\f[B]:\f[R] \[dq]0.0.0.0:53/udp\[dq]
    connect\f[B]:\f[R]
      \f[B]\-\f[R] dest\f[B]:\f[R] \[dq]8.8.8.8:53/udp\[dq]
      \f[B]\-\f[R] dest\f[B]:\f[R] \[dq]8.8.4.4:53/udp\[dq]
      \f[B]\-\f[R] dest\f[B]:\f[R] \[dq]1.1.1.1:53/udp\[dq]
    load_balancing\f[B]:\f[R]
      algorithm\f[B]:\f[R] leastconn
    timeout\f[B]:\f[R] 10

\f[I]  # Application servers with sticky sessions\f[R]
  \f[B]\-\f[R] name\f[B]:\f[R] app\-cluster
    bind\f[B]:\f[R] \[dq]0.0.0.0:8080/tcp\[dq]
    connect\f[B]:\f[R]
      \f[B]\-\f[R] dest\f[B]:\f[R] \[dq]app1.internal:3000\[dq]
        dns_refresh\f[B]:\f[R] 60
      \f[B]\-\f[R] dest\f[B]:\f[R] \[dq]app2.internal:3000\[dq]
        dns_refresh\f[B]:\f[R] 60
    load_balancing\f[B]:\f[R]
      algorithm\f[B]:\f[R] iphash
      affinity_ttl\f[B]:\f[R] 3600
      affinity_max_entries\f[B]:\f[R] 50000

\f[I]  # Docker socket proxy\f[R]
  \f[B]\-\f[R] name\f[B]:\f[R] docker\-proxy
    bind\f[B]:\f[R] \[dq]0.0.0.0:2375/tcp\[dq]
    connect\f[B]:\f[R] \[dq]unix:/var/run/docker.sock\[dq]
    access\f[B]:\f[R]
      allow\f[B]:\f[R] \f[B][\f[R]\[dq]10.0.0.*\[dq]\f[B]]\f[R]
      deny\f[B]:\f[R] \f[B][\f[R]\[dq]*\[dq]\f[B]]\f[R]
.EE
.SS REINITIALIZING RINETD\-UV
The SIGHUP signal can be used to cause \f[B]rinetd\-uv\f[R] to reload
its configuration file without interrupting existing connections.
.IP
.EX
kill \-HUP $(cat /var/run/rinetd\-uv.pid)
.EE
.PP
Or simply:
.IP
.EX
killall \-HUP rinetd\-uv
.EE
.SS BUGS AND LIMITATIONS
\f[B]rinetd\-uv\f[R] only redirects protocols which use a single TCP or
UDP socket.
This rules out FTP (which uses multiple connections for data transfer).
.PP
The server redirected to is not able to identify the host the client
really came from.
This cannot be corrected; however, the log produced by
\f[B]rinetd\-uv\f[R] provides a way to obtain this information.
.PP
Two rules with the same source ip/port and different destination ip/port
are not allowed (you\[cq]ll get \[lq]Address already in use\[rq] or
similar error).
Note that \f[CR]0.0.0.0\f[R] (IPv4) and \f[CR]::\f[R] (IPv6) effectively
mean the same (both would bind to \[lq]any\[rq] address).
.PP
\f[B]rinetd\-uv\f[R] does not implement backpressure (flow control)
between the client and backend connections.
If one endpoint sends data faster than the other endpoint can receive
it, the data waiting to be forwarded will queue up in memory.
In extreme cases (e.g., a fast sender paired with a very slow or stalled
receiver), this can lead to unbounded memory growth.
This is generally not a problem for well\-behaved clients and backends,
but could be exploited in adversarial scenarios where an attacker
deliberately sends data rapidly while receiving slowly.
.SS Incompatibilities
\f[B]rinetd\-uv\f[R] was meant as drop\-in replacement for
\f[B]rinetd\f[R], although there are some differences
.IP \[bu] 2
logging format and behavior changed slightly: date is in the iso8601
format (yyyy\-mm\-ddThh:mm:ss+tz:tz), for every connection 2 lines are
logged \- one with `open' result and one with `done\-' result (this
entry contains valid values for transferred data sizes)
.IP \[bu] 2
\f[CR]pidlogfile\f[R] option was renamed to \f[CR]pidfile\f[R]
.IP \[bu] 2
original rinetd mentioned possibility to proxy traffic between differen
protocols (UDP <\-> TCP), in \f[B]rinetd\-uv\f[R] it\[cq]s not possible
due to fundamental protocol incompatibilities.
See \f[CR]TCP\-UDP_MIXED_MODE.md\f[R] for technical details.
.SS PERFORMANCE NOTES
\f[B]rinetd\-uv\f[R] uses libuv for event\-driven I/O, providing
excellent performance characteristics:
.IP \[bu] 2
Single\-process, event\-driven architecture
.IP \[bu] 2
Dynamic buffer pool with lazy trimming reduces allocation overhead
.IP \[bu] 2
Efficient handling of thousands of concurrent connections
.IP \[bu] 2
Low CPU overhead per connection
.PP
Memory usage can be tuned via the \f[CR]buffersize\f[R] and
\f[CR]pool\-*\f[R] options.
Typical memory usage:
.IP
.EX
Total Memory = bufferSize × pool\-max\-free  (maximum pooled buffers)
             + bufferSize × active_connections  (in\-flight data)
.EE
.PP
For high\-performance deployments, consider: \- Using larger buffer
sizes (64 KB \- 128 KB) for better throughput \- Using smaller buffer
sizes (2 KB \- 8 KB) when memory is constrained \- Tuning
\f[CR]pool\-min\-free\f[R] to match typical concurrent connection count
\- Setting \f[CR]pool\-trim\-delay\f[R] lower (10\-30 seconds) for
memory\-constrained systems
.SS Operating system optimization
There are assorted system\-level settings that may affect rinetd\-uv
behavior, especially for higher loads (thousands connections per second
or high bandwidth).
.SS Open files
Many of UDP\-related scenarios require increasing limit of open files: *
local limit (\f[CR]ulimit \-n\f[R]) * global/kernel limit \- Linux:
fs.file\-max and fs.nr_open \- FreeBSD: kern.maxfiles and
kern.maxfilesperproc
.SS Max network buffer size
Rinetd\-uv sets both buffer sizes (send and receive, known as SO_SNDBUF
and SO_RCVBUF) to twice the value of \f[CR]buffersize\f[R] configuration
variable (2 x 64KB by default).
You may try to increase this value if required but operating system
limits and behavior may affect possibility to manipulate that.
.IP \[bu] 2
FreeBSD \- refer to \f[B]tuning(7)\f[R] man page for details
.RS 2
.IP \[bu] 2
\f[CR]kern.ipc.maxsockbuf\f[R]
.IP \[bu] 2
\f[CR]net.inet.udp.maxdgram\f[R]
.IP \[bu] 2
\f[CR]net.inet.tcp.sendbuf_max\f[R]
.IP \[bu] 2
\f[CR]net.inet.tcp.recvbuf_max\f[R]
.IP \[bu] 2
\f[CR]net.inet.tcp.sendbuf_auto\f[R] \[en] Send buffer autotuning
.IP \[bu] 2
\f[CR]net.inet.tcp.recvbuf_auto\f[R] \[en] Receive buffer autotuning
.IP \[bu] 2
\f[CR]net.inet.tcp.sendspace\f[R]
.IP \[bu] 2
\f[CR]net.inet.tcp.recvspace\f[R]
.IP \[bu] 2
\f[CR]net.local.stream.recvspace\f[R] \[en] unix sockets
.IP \[bu] 2
\f[CR]net.local.stream.sendspace\f[R]
.IP \[bu] 2
\f[CR]net.local.dgram.maxdgram\f[R] \[en] unix datagram sockets, not
supported yet
.IP \[bu] 2
\f[CR]net.local.dgram.recvspace\f[R]
.RE
.SS Backlog
While it\[cq]s possible to configure baclog queue length with
\f[CR]backlog\f[R] configuration option \- there are system level limits
as well:
.IP \[bu] 2
Linux
.RS 2
.IP \[bu] 2
\f[CR]net.core.somaxconn\f[R]
.IP \[bu] 2
\f[CR]net.core.netdev_max_backlog\f[R]
.IP \[bu] 2
\f[CR]net.ipv4.tcp_max_syn_backlog\f[R]
.RE
.IP \[bu] 2
FreeBSD
.RS 2
.IP \[bu] 2
\f[CR]kern.ipc.soacceptqueue\f[R]
.IP \[bu] 2
\f[CR]kern.ipc.somaxconn\f[R] \[en] legacy name
.RE
.SS Other tuning
There are many parameters that needs to be adjusted in case of demanding
environment and specific use cases.
Check applicable documentation.
Below you can find some tunables that should be checked:
.IP \[bu] 2
Linux
.RS 2
.IP \[bu] 2
\f[CR]net.ipv4.tcp_keepalive_*\f[R]
.IP \[bu] 2
\f[CR]net.ipv4.tcp_mtu_probing\f[R]
.IP \[bu] 2
\f[CR]net.ipv4.tcp_tw_reuse\f[R]
.IP \[bu] 2
\f[CR]net.ipv4.tcp_max_tw_buckets\f[R]
.IP \[bu] 2
\f[CR]net.core.rmem_*\f[R]
.IP \[bu] 2
\f[CR]net.core.wmem_*\f[R]
.IP \[bu] 2
\f[CR]net.ipv4.tcp_rmem\f[R]
.IP \[bu] 2
\f[CR]net.ipv4.tcp_wmem\f[R]
.IP \[bu] 2
\f[CR]net.ipv4.udp_rmem_min\f[R]
.IP \[bu] 2
\f[CR]net.ipv4.udp_wmem_min\f[R]
.IP \[bu] 2
\f[CR]net.ipv4.tcp_mtu_probing\f[R]
.IP \[bu] 2
\f[CR]net.ipv4.ip_local_port_range\f[R]
.RE
.IP \[bu] 2
FreeBSD
.RS 2
.IP \[bu] 2
\f[CR]kern.ipc.maxpipekva\f[R] \[en] for unix sockets
.IP \[bu] 2
\f[CR]kern.ipc.nmbclusters\f[R]
.IP \[bu] 2
\f[CR]kern.ipc.nmbjumbop\f[R]
.IP \[bu] 2
\f[CR]net.inet.ip.portrange.*\f[R]
.IP \[bu] 2
\f[CR]net.inet.tcp.always_keepalive\f[R]
.IP \[bu] 2
\f[CR]net.inet.tcp.cc.*\f[R]
.IP \[bu] 2
\f[CR]net.inet.tcp.fast_finwait2_recycle\f[R]
.IP \[bu] 2
\f[CR]net.inet.tcp.minmss\f[R]
.IP \[bu] 2
\f[CR]net.inet.tcp.mssdflt\f[R]
.IP \[bu] 2
\f[CR]net.inet.tcp.rfc1323\f[R]
.IP \[bu] 2
\f[CR]net.inet.tcp.syncache.*\f[R]
.IP \[bu] 2
\f[CR]net.link.ifqmaxlen\f[R]
.RE
.SS LICENSE
Copyright (c) 1997, 1998, 1999, Thomas Boutell and Boutell.Com, Inc.
.PP
Copyright (c) 2003\-2025 Sam Hocevar
.PP
Copyright (c) 2026 Marcin Gryszkalis
.PP
This software is released for free use under the terms of the GNU
General Public License, version 2 or higher.
NO WARRANTY IS EXPRESSED OR IMPLIED.
USE THIS SOFTWARE AT YOUR OWN RISK.
.SS CONTACT INFORMATION
See https://github.com/marcin\-gryszkalis/rinetd for the latest release.
.PP
\f[B]Marcin Gryszkalis\f[R] can be reached by email: mg\[at]fork.pl
.PP
\f[B]Sam Hocevar\f[R] can be reached by email: sam\[at]hocevar.net
.PP
\f[B]Thomas Boutell\f[R] can be reached by email:
boutell\[at]boutell.com
.SS THANKS
Thanks are due to Bill Davidsen, Libor Pechachek, Sascha Ziemann, the
Apache Group, and many others who have contributed advice and/or source
code to this and other free software projects.
.SS LLM
This implementation (rinetd\-uv since version 2.0.0) was created with
support of assorted LLM models and agents (Claude Opus, Claude Sonnet,
Gemini, GPT).
The architecure and code was always reviewed by human.
.SS SEE ALSO
.SS Links
.IP \[bu] 2
rinetd\-uv: https://github.com/marcin\-gryszkalis/rinetd
.IP \[bu] 2
original rinetd: https://github.com/samhocevar/rinetd
.SS Additional Documentation
.IP \[bu] 2
BUILD.md \- Build requirements and instructions
.IP \[bu] 2
SECURITY.md \- Security policy
.IP \[bu] 2
CHANGES.md \- Changelog
.IP \[bu] 2
TCP\-UDP_MIXED_MODE.md \- Technical analysis of mixed\-mode limitations
